<!-- Form Header -->
<div class="card-header">
    <h2>Create Announcement</h2>
</div>

<form #sendAnnouncement="ngForm" (ngSubmit)="onSubmit(sendAnnouncement)">
    <div class="form-layout">
        <!-- Left Section -->
        <div class="left-side">
            <!-- Combined Category and Title Container -->
            <div class="container combined-container">
                <div class="form-group">
                    <label for="category">Category</label>
                    <p-dropdown id="category" name="category" [(ngModel)]="selectedCategory" [options]="categories"
                        placeholder="Select a category" optionLabel="name" optionValue="id" required>
                    </p-dropdown>
                    <!-- <div *ngIf="!selectedCategory && sendAnnouncement.submitted" class="invalid-feedback">
                        Category is required
                    </div> -->
                </div>

                <div class="form-group">
                    <label for="title">Title</label>
                    <input type="text" id="title" name="title" [(ngModel)]="title" required />
                    <div *ngIf="!title && sendAnnouncement.submitted" class="invalid-feedback">
                        Title is required
                    </div>
                </div>
            </div>

            <!-- Announcement Container -->
            <div class="container short-input">
                <div class="form-group">
                    <label for="media">Announcement</label>
                    <p-toolbar>
                        <div class="p-toolbar-group-left">
                            <button type="button" pButton label="Open" icon="pi pi-folder-open"
                                class="p-button-secondary mr-2" (click)="fileInput.click()"></button>
                        </div>
                    </p-toolbar>
                    <input type="file" id="media" name="media"
                        accept="audio/*,video/*,image/*,application/pdf,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                        (change)="onFileChange($event)" #fileInput style="display: none;" />
                    <div *ngIf="filePreview">
                        <p class="mt-3">File selected: {{filename}}</p>
                        <div *ngIf="isImage()">
                            <img [src]="filePreview" alt="Preview" class="img-fluid mt-3">
                        </div>
                        <div *ngIf="isVideo()">
                            <video [src]="filePreview" controls class="mt-3"></video>
                        </div>
                        <div *ngIf="isAudio()">
                            <audio [src]="filePreview" controls class="mt-3"></audio>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Options -->
            <div class="container">
                <div class="form-group">
                    <label>Schedule:</label>
                    <div class="schedule-options">
                        <div class="form-check-inline">
                            <input class="form-check-input" type="radio" name="schedule" id="schedule-now" value="now"
                                [(ngModel)]="scheduleOption" (change)="toggleDatePicker(false)" required />
                            <label class="form-check-label" for="schedule-now">Now</label>
                        </div>
                        <div class="form-check-inline">
                            <input class="form-check-input" type="radio" name="schedule" id="schedule-later" value="later"
                                [(ngModel)]="scheduleOption" (change)="toggleDatePicker(true)" required />
                            <label class="form-check-label" for="schedule-later">Later</label>
                        </div>
                    </div>
                    <div *ngIf="!scheduleOption && sendAnnouncement.submitted" class="invalid-feedback">
                        Schedule option is required
                    </div>
                </div>

                <!-- Date Picker Container -->
                <div class="form-group" *ngIf="showDatePicker">
                    <label for="schedule-date">Select Date and Time</label>
                    <p-calendar id="schedule-date" name="schedule-date" [(ngModel)]="scheduleDate" required
                        showTime="true" hourFormat="24"></p-calendar>
                    <div *ngIf="!scheduleDate && sendAnnouncement.submitted" class="invalid-feedback">
                        Date and time are required
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Section -->
        <div class="right-side">
            <!-- Target Container -->
            <div class="container">
                <div class="form-group">
                    <label>Target</label>
                    <p-tree [value]="companies" selectionMode="checkbox" [(selection)]="selectedTargets"
                        [propagateSelectionDown]="true" [propagateSelectionUp]="true">
                    </p-tree>
                    <!-- <div *ngIf="!selectedTargets.length && sendAnnouncement.submitted" class="invalid-feedback">
                        At least one target is required
                    </div> -->
                </div>
            </div>

            <!-- Custom Target -->

        </div>
    </div>

    <!-- Submit Button Section -->
    <div class="form-actions">
        <button pButton pRipple type="submit" [disabled]="sendAnnouncement.invalid || !selectedTargets.length" label="Create"
            icon="pi pi-check" class="btn-primary"></button>
        <button pButton pRipple type="button" label="Save" icon="pi pi-save" class="btn-success" [disabled]="sendAnnouncement.invalid || !selectedTargets.length"
            (click)="saveDraft()"></button>
        <button pButton pRipple type="reset" (click)="clearPreview()" label="Cancel"
            class="btn-secondary"></button>
        <button pButton pRipple type="button" label="Delete" icon="pi pi-trash" class="btn-danger"></button>
    </div>
</form>

<!-- Styles -->
<style>
    /* Styles for media elements */
    video, img {
        max-width: 100%;
        height: auto;
        max-height: 400px;
        border-radius: 5px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        margin-top: 10px;
    }

    /* Form layout styles */
    .card-header {
        padding: 15px;
        text-align: center;
        background-color: #f8f9fa;
        margin-bottom: 20px;
    }

    .form-layout {
        display: flex;
        gap: 2rem;
    }

    .left-side,
    .right-side {
        flex: 1;
    }

    /* Container styles */
    .combined-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .container {
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 10px;
        background-color: #ffffff;
        box-shadow: 0 2px 4px rgba(125, 123, 123, 0.1);
    }

    /* Input and button styles */
    input[type="text"],
    input[type="file"] {
        max-width: 300px;
        padding: 10px;
        border: 1px solid #ced4da;
        border-radius: 6px;
        transition: border-color 0.3s;
        font-size: 16px;
    }

    input:focus {
        border-color: #007bff;
        outline: none;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    .btn-primary,
    .btn-success,
    .btn-secondary,
    .btn-danger {
        border: none;
        border-radius: 6px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s;
        color: #ffffff;
    }

    .btn-primary {
        background-color: #007bff;
    }

    .btn-success {
        background-color: #28a745;
    }

    .btn-secondary {
        background-color: #6c757d;
    }

    .btn-danger {
        background-color: #dc3545;
    }

    /* Schedule options styles */
    .schedule-options {
        display: flex;
        align-items: center;
    }

    .form-check-inline {
        display: flex;
        align-items: center;
        margin-right: 1rem;
    }

    .form-check-label {
        margin-left: 5px;
    }
</style>
