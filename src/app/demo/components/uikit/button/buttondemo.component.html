<div class="button-container">
    <p-menu [model]="items"></p-menu>
</div>

<!-- Hidden file input for Excel upload -->
<div class="file-upload-container">
    <label for="fileInput" class="file-upload-label">
        <i class="pi pi-upload"></i> Upload Excel File
    </label>
    <input type="file" id="fileInput" (change)="onFileChange($event)" accept=".xlsx, .xls" style="display: none;" />
</div>

<!-- Display the JSON data in a table -->
<div *ngIf="jsonData.length > 0" class="data-table-container">
    <h3>Uploaded Excel Data:</h3>
    <table class="data-table">
        <thead>
            <tr>
                <th *ngFor="let header of jsonData[0]">{{ header }}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of jsonData.slice(1); let i = index">
                <td *ngFor="let cell of row; let j = index">
                    {{ cell }}

                    <!-- Show warning icon next to the field if there's an issue -->
                    <span *ngIf="getFieldError(i + 2, j)"
                        (click)="showErrorMessage({ row: i + 2, col: j, message: getFieldError(i + 2, j)?.message })">
                        <i [ngClass]="getFieldError(i + 2, j)?.type === 'warning' ? 'pi pi-exclamation-triangle warning-icon' : ''"></i>
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
</div>